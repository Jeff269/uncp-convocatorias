{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\xampp\\\\htdocs\\\\www\\\\SISConvocatorias\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Injectable } from '@angular/core';\nlet AuthGuard = class AuthGuard {\n  constructor(auth, router) {\n    this.auth = auth;\n    this.router = router;\n  }\n\n  canActivate() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      //return true;\n      yield _this.auth.validarLoginPromise().then(res => {\n        //console.log(res)\n        if (res.code == 200) {\n          //console.log(res)\n          //console.log(\"token valido\");\n          return true;\n        } else {\n          if (res.code == 300) {\n            _this.router.navigate(['/unauthorized']);\n\n            return false;\n          } else {\n            if (res.code == 404) {\n              //console.log(\"token invalido\");\n              _this.auth.removeToken();\n\n              window.location.href = '/login.php'; //this.router.navigate(['/login.php']);\n\n              return false;\n            } else {\n              console.log(\"error con la base de datos\");\n\n              _this.auth.removeToken();\n\n              window.location.href = '/login.php';\n              return false;\n            }\n          }\n        }\n      });\n      return true;\n    })();\n  }\n\n  canActivateChild() {\n    return true;\n  }\n\n};\nAuthGuard = __decorate([Injectable({\n  providedIn: 'root'\n})], AuthGuard);\nexport { AuthGuard };","map":{"version":3,"sources":["C:/xampp/htdocs/www/SISConvocatorias/frontend/src/app/auth.guard.ts"],"names":["__decorate","Injectable","AuthGuard","constructor","auth","router","canActivate","validarLoginPromise","then","res","code","navigate","removeToken","window","location","href","console","log","canActivateChild","providedIn"],"mappings":";AAAA,SAASA,UAAT,QAA2B,OAA3B;AACA,SAASC,UAAT,QAA2B,eAA3B;AACA,IAAIC,SAAS,GAAG,MAAMA,SAAN,CAAgB;AAC5BC,EAAAA,WAAW,CAACC,IAAD,EAAOC,MAAP,EAAe;AACtB,SAAKD,IAAL,GAAYA,IAAZ;AACA,SAAKC,MAAL,GAAcA,MAAd;AACH;;AACKC,EAAAA,WAAW,GAAG;AAAA;;AAAA;AAChB;AACA,YAAM,KAAI,CAACF,IAAL,CAAUG,mBAAV,GAAgCC,IAAhC,CAAqCC,GAAG,IAAI;AAC9C;AACA,YAAIA,GAAG,CAACC,IAAJ,IAAY,GAAhB,EAAqB;AACjB;AACA;AACA,iBAAO,IAAP;AACH,SAJD,MAKK;AACD,cAAID,GAAG,CAACC,IAAJ,IAAY,GAAhB,EAAqB;AACjB,YAAA,KAAI,CAACL,MAAL,CAAYM,QAAZ,CAAqB,CAAC,eAAD,CAArB;;AACA,mBAAO,KAAP;AACH,WAHD,MAIK;AACD,gBAAIF,GAAG,CAACC,IAAJ,IAAY,GAAhB,EAAqB;AACjB;AACA,cAAA,KAAI,CAACN,IAAL,CAAUQ,WAAV;;AACAC,cAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,YAAvB,CAHiB,CAIjB;;AACA,qBAAO,KAAP;AACH,aAND,MAOK;AACDC,cAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ;;AACA,cAAA,KAAI,CAACb,IAAL,CAAUQ,WAAV;;AACAC,cAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,YAAvB;AACA,qBAAO,KAAP;AACH;AACJ;AACJ;AACJ,OA5BK,CAAN;AA6BA,aAAO,IAAP;AA/BgB;AAgCnB;;AACDG,EAAAA,gBAAgB,GAAG;AACf,WAAO,IAAP;AACH;;AAxC2B,CAAhC;AA0CAhB,SAAS,GAAGF,UAAU,CAAC,CACnBC,UAAU,CAAC;AACPkB,EAAAA,UAAU,EAAE;AADL,CAAD,CADS,CAAD,EAInBjB,SAJmB,CAAtB;AAKA,SAASA,SAAT","sourcesContent":["import { __decorate } from \"tslib\";\r\nimport { Injectable } from '@angular/core';\r\nlet AuthGuard = class AuthGuard {\r\n    constructor(auth, router) {\r\n        this.auth = auth;\r\n        this.router = router;\r\n    }\r\n    async canActivate() {\r\n        //return true;\r\n        await this.auth.validarLoginPromise().then(res => {\r\n            //console.log(res)\r\n            if (res.code == 200) {\r\n                //console.log(res)\r\n                //console.log(\"token valido\");\r\n                return true;\r\n            }\r\n            else {\r\n                if (res.code == 300) {\r\n                    this.router.navigate(['/unauthorized']);\r\n                    return false;\r\n                }\r\n                else {\r\n                    if (res.code == 404) {\r\n                        //console.log(\"token invalido\");\r\n                        this.auth.removeToken();\r\n                        window.location.href = '/login.php';\r\n                        //this.router.navigate(['/login.php']);\r\n                        return false;\r\n                    }\r\n                    else {\r\n                        console.log(\"error con la base de datos\");\r\n                        this.auth.removeToken();\r\n                        window.location.href = '/login.php';\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return true;\r\n    }\r\n    canActivateChild() {\r\n        return true;\r\n    }\r\n};\r\nAuthGuard = __decorate([\r\n    Injectable({\r\n        providedIn: 'root'\r\n    })\r\n], AuthGuard);\r\nexport { AuthGuard };\r\n"]},"metadata":{},"sourceType":"module"}